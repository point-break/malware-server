import {sign, verify} from 'jsonwebtoken'

export const createToken = (data) => {
  const expires = new Date()
  expires.setMonth(expires.getMonth() + 1)
  const expiresIn = (expires - new Date()) / 100
  const token = sign(
    data,
    process.env.JWT_SECRET,
    {
      expiresIn
    }
  )
  return {token, expires}
}

export const verifyToken = (token) => {
  let decoded
  try {
    decoded = verify(token, process.env.JWT_SECRET)
  } catch(err) {
    decoded = err
  }
  return decoded
}
