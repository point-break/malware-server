import {Strategy} from 'model'

export default ({strategy}) => Strategy
  .filter(strategy)
  .getJoin({user: true})
  .nth(0)
  .default(null)
  .run()
  .then(document => {
    if (document != null) {
      return document
    }
  })
  .catch(error => {
    if (error.name === 'DocumentNotFoundError') {
      return new Strategy(strategy)
        .save()
    }
    return error
  })
